name: Vulnerable CI Pipeline
on:
  pull_request_target:          # âš ï¸ DANGER: Runs in base repo context
    types: [opened, reopened]

jobs:
  security-breach:
    runs-on: ubuntu-latest
    steps:
      # âš ï¸ CRITICAL: Checks out attacker's code from fork
      - name: Checkout Attacker Code
        uses: actions/checkout@v5
        with:
          ref: ${{ github.event.pull_request.head.sha }}

      # ğŸš¨ PROOF: Attacker's code executes in privileged context
      - name: Execute Untrusted Code
        run: |
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘    CRITICAL CI/CD VULNERABILITY - LIVE POC    â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "ğŸ”´ VULNERABILITY: pull_request_target exploitation"
          echo "âœ… STATUS: ACTIVE AND EXPLOITING"
          echo ""
          echo "ğŸ“Š PRIVILEGED CONTEXT ACCESSED:"
          echo "   â€¢ Repository: ${{ github.repository }}"
          echo "   â€¢ Event: ${{ github.event_name }}"
          echo "   â€¢ Fork SHA: ${{ github.event.pull_request.head.sha }}"
          echo "   â€¢ GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN != '' }}"
          echo ""
          echo "ğŸ¯ ATTACKER CAPABILITIES:"
          echo "   âœ… Read ALL repository secrets"
          echo "   âœ… Write to protected branches"
          echo "   âœ… Modify CI/CD configurations"
          echo "   âœ… Inject backdoor into production"
          echo "   âœ… Exfiltrate credentials"
          echo ""
          echo "â³ Simulating attack execution..."
          sleep 15
          echo ""
          echo "âœ… EXPLOIT SUCCESSFUL"
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘     VULNERABILITY CONFIRMED - PATCH REQUIRED  â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
